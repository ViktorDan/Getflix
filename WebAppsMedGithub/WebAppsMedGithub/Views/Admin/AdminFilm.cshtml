@model List<Model.Filmer>

@{
    ViewBag.Title = "AdminFilm";
}
<head>
    <style>
        th {
            width: 14%;
        }
    </style>
    <script type="text/javascript">
        $(document).ready(function () {
            $('a[data-sletteModal=true]').click(function () {
                var dataNavn = $(this).data('navn');
                var dataId = $(this).data('id');

                $('#slettNavn').html(dataNavn);

                $('#sletteModalKnapp').click(function () {
                    $.ajax({
                        url: '@Url.Action("SlettFilm", "Admin")',
                        data: { id: dataId },
                        success: function () {
                            $.ajax({
                                url: '@Url.Action("AdminFilm", "Admin")',
                                success: function () {
                                    window.location.reload();
                                }
                            });
                        }
                    });
                });
            });
            $('a[data-endreModal=true]').click(function () {
                var dataId = $(this).data('id');
                var dataTittel = $(this).data('tittel');
                var dataAar = $(this).data('aar');
                var dataLen = $(this).data('len');
                var dataStor = $(this).data('stor');
                var dataSjanger = $(this).data('sjanger');
                var dataPris = $(this).data('pris');
                var dataBilde = $(this).data('bilde');

                $('#endreNavn').html("<tr><td>Id</td><td>"+ dataId +"</td></tr>"
                    + "<tr><td>Tittel</td><td><input id='tittel' value='"+dataTittel+"' class='form-control'></input></td></tr>"
                    + "<tr><td>Utgitt år</td><td><input id='aar' value='" + dataAar + "' class='form-control'></input></td></tr>"
                    + "<tr><td>Sjanger</td><td><input id='sjan' value='" + dataSjanger + "' class='form-control'></input></td></tr>"
                    + "<tr><td>Lengde</td><td><input id='len' value='" + dataLen +"' class='form-control'></input></td></tr>"
                    + "<tr><td>Størrelse</td><td><input id='stor' value='" + dataStor +"' class='form-control'></input></td></tr>"
                    + "<tr><td>Pris</td><td><input id='pris' value='" + dataPris +"' class='form-control'></input></td></tr>");

                $('#endreModalKnapp').click(function () {
                    
                    var tittel = $('#tittel').val();
                    var aar = $('#aar').val();
                    var sjan = $('#sjan').val();
                    var len = $('#len').val();
                    var stor = $('#stor').val();
                    var pris = $('#pris').val();

                    $.ajax({
                        url: '@Url.Action("EndreFilm", "Admin")',
                        data: { id: dataId, tittel: tittel, aar: aar, sjan: sjan, len: len, stor: stor, pris: pris },
                        success: function () {
                            $.ajax({
                                url: '@Url.Action("AdminFilm", "Admin")',
                                success: function () {
                                    window.location.reload();
                                }
                            });
                        }
                    });
                });
            });
        });
    </script>
</head>
<body>
    <div id="navbar" class="navbar navbar-inverse navbar-fixed-top">
        <div class="container">
            <div class="navbar-header">
                <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
                @Html.ActionLink("Getflix - Admin", "Admin", "Admin", new { area = "" }, new { @class = "navbar-brand", id = "getflixKnapp" })
            </div>
            <div class="navbar-collapse collapse">
                <ul class="nav navbar-nav">
                    <li>@Html.ActionLink("Kunder", "AdminKunder")</li>
                    <li>@Html.ActionLink("Filmer", "AdminFilm")</li>
                    <li>@Html.ActionLink("Bestilling", "AdminBestilling")</li>
                </ul>
                <ul class="nav navbar-nav pull-right">
                    <li>@Html.ActionLink("Logg ut", "LoggUt")</li>
                </ul>
            </div>
        </div>
    </div>

    <h2>Administrer Film</h2>
    <br />
    <div>
        <table>
            <tr>
                <th></th>
                <th>Film id</th>
                <th>Tittel</th>
                <th>År</th>

            </tr>
            @foreach (var film in Model)
            {
                <tr>
                    <td><input type="checkbox"/></td>
                    <td>@film.FId</td>
                    <td>@film.Navn</td>
                    <td>@film.Aar</td>
                    
                    <td>
                        <a href="#endreModal" class="btn btn-default" id="endreKnapp"
                           data-id="@film.FId" data-tittel="@film.Navn" data-aar="@film.Aar"
                           data-len="@film.Lengde" data-stor="@film.Storrelse" data-sjanger="@film.Sjanger" 
                           data-pris="@film.Pris" data-bilde="@film.Bilde" data-toggle="modal" data-endreModal="true">Endre</a>
                        <a href="#sletteModal" class="btn btn-danger" id="sletteKnapp"
                           data-navn="@film.FId @film.Navn @film.Bilde"
                           data-id="@film.FId" data-toggle="modal" data-sletteModal="true">Slett</a>
                    </td>
                </tr>
            }
        </table>
        @Html.Partial("sletteModal")
        @Html.Partial("endreModal")
    </div>

</body>